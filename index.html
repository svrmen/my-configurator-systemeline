<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Конфигуратор шинопровода Systemeline B</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="configurator-container">
        <div class="configurator-form">
            <h1>Конфигуратор шинопровода Systemeline B</h1>
            
            <div class="input-group">
                <label for="project-name">Наименование проекта:</label>
                <input type="text" id="project-name" placeholder="Введите название проекта" required>
            </div>
            
            <div class="input-section">
                <form id="busbar-form">
                    <div class="error-message"></div>
                    
                    <div class="input-group">
                        <label for="current">Номинальный ток (A):</label>
                        <select id="current" required>
                            <option value="400">400</option>
                            <option value="500">500</option>
                            <option value="630">630</option>
                            <option value="800">800</option>
                            <option value="1000">1000</option>
                            <option value="1250">1250</option>
                            <option value="1600">1600</option>
                            <option value="2000">2000</option>
                            <option value="2500">2500</option>
                            <option value="3200">3200</option>
                            <option value="4000">4000</option>
                            <option value="5000">5000</option>
                            <option value="6300" class="copper-only">6300</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="material">Материал проводника:</label>
                        <select id="material" required>
                            <option value="aluminum">Алюминий</option>
                            <option value="copper">Медь</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="start-point">Начальная точка:</label>
                        <select id="start-point" required>
                            <option value="none">Нет</option>
                            <option value="transformer">Трансформатор</option>
                            <option value="grsh">ГРЩ</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="end-point">Конечная точка основной трассы:</label>
                        <select id="end-point" required>
                            <option value="none">Нет</option>
                            <option value="transformer">Трансформатор</option>
                            <option value="grsh">ГРЩ</option>
                            <option value="endcap">Концевая заглушка</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="total-length">Общая длина основной трассы (м):</label>
                        <input type="number" id="total-length" min="0.4" max="100" step="0.1" value="10" required>
                    </div>

                    <div class="input-group">
                        <label for="mounting-step">Шаг креплений (м):</label>
                        <input type="number" id="mounting-step" min="0.5" max="3" step="0.1" value="1" required>
                    </div>

                    <div id="segments-container">
                        <div class="segment-input" data-id="1">
                            <label>Сегмент 1 (длина, м):</label>
                            <input type="number" class="segment-length" min="0.4" max="50" step="0.1" value="10" required>
                            
                            <label>Тип блока после сегмента:</label>
                            <select class="block-type">
                                <option value="none">Нет</option>
                                <option value="angle">Угловой поворот</option>
                                <option value="tee">Т-образный отвод</option>
                                <option value="outlet">Отводной блок с выключателем</option>
                            </select>
                            
                            <div class="direction-group" style="display: none;">
                                <label>Направление:</label>
                                <select class="direction">
                                    <option value="right">Вправо</option>
                                    <option value="left">Влево</option>
                                    <option value="up">Вверх</option>
                                    <option value="down">Вниз</option>
                                </select>
                                
                                <label class="angle-label">Угол (°):</label>
                                <input type="number" class="angle" min="0" max="90" value="90" disabled>
                            </div>
                            
                            <div class="branch-group" style="display: none; margin-top: 10px; padding: 10px; background: #e8f4fc; border-radius: 4px;">
                                <h4>Ответвление:</h4>
                                <div class="input-group">
                                    <label>Длина ответвления (м):</label>
                                    <input type="number" class="branch-length" min="0.4" max="50" step="0.1" value="5">
                                </div>
                                
                                <div class="input-group">
                                    <label>Конечная точка ответвления:</label>
                                    <select class="branch-end-point">
                                        <option value="none">Нет</option>
                                        <option value="transformer">Трансформатор</option>
                                        <option value="grsh">ГРЩ</option>
                                        <option value="endcap">Концевая заглушка</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="outlet-group" style="display: none; margin-top: 10px; padding: 10px; background: #e0f7fa; border-radius: 4px;">
                                <h4>Отводной блок с выключателем:</h4>
                                <div class="input-group">
                                    <label>Номинал блока (A):</label>
                                    <select class="outlet-current">
                                        <option value="125">125</option>
                                        <option value="160">160</option>
                                        <option value="250">250</option>
                                        <option value="400">400</option>
                                        <option value="500">500</option>
                                        <option value="630">630</option>
                                        <option value="800">800</option>
                                        <option value="1000">1000</option>
                                        <option value="1250">1250</option>
                                        <option value="1600">1600</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="input-group">
                        <button type="button" id="add-segment">+ Добавить сегмент</button>
                        <button type="button" id="remove-segment">- Удалить сегмент</button>
                    </div>

                    <div class="input-group">
                        <label for="ip">Степень защиты:</label>
                        <select id="ip" required>
                            <option value="IP55">IP55</option>
                            <option value="IP65">IP65</option>
                            <option value="IP68">IP68</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="fireproof">Огнестойкое исполнение:</label>
                        <select id="fireproof" required>
                            <option value="no">Нет</option>
                            <option value="yes">Да (180 мин при 550°C)</option>
                        </select>
                    </div>

                    <button type="submit">Рассчитать</button>
                </form>
            </div>

            <div class="output-section">
                <div class="result-box">
                    <h3>Результаты подбора:</h3>
                    <div id="calculation-result"></div>
                    <div id="components-list"></div>
                    <div id="total-price"></div>
                    
                    <div class="input-group" style="margin-top: 20px;">
                        <button type="button" id="export-excel">Выгрузить в Excel</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="drawing-section">
            <h3>Чертеж трассы:</h3>
            <canvas id="busbar-canvas" width="800" height="600"></canvas>
        </div>
    </div>

    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
